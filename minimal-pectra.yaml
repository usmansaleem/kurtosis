participants_matrix:
  el:
   - el_type: geth
     el_image: ethereum/client-go:latest
   - el_type: besu
     el_image: hyperledger/besu:latest
     el_log_level: "trace"
     el_extra_env_vars:
       BESU_XENABLE_EXTRA_DEBUG_TRACERS: "true"
       LOG4J_CONFIGURATION_FILE: "/config/log4j2.xml"
     el_extra_mounts: {"/config": "log4j2.xml"}
  cl:
   - cl_type: teku
     cl_image: consensys/teku:develop
     count: 1

network_params:
  preset: minimal
  electra_fork_epoch: 1
  min_validator_withdrawability_delay: 1
  shard_committee_period: 1
  churn_limit_quotient: 16
  genesis_delay: 120
  
additional_services:
  - dora
  - tx_fuzz

dora_params:
  image: "ethpandaops/dora:master-latest"

spamoor_params:
  image: "ethpandaops/spamoor:latest"
  spammers:
    - scenario: eoatx
      name: "Standard EOA Transaction"
      config:
        throughput: 5   # 5 transactions per slot


#global_log_level: 'info'
# If set, the package will block until a finalized epoch has occurred.
wait_for_finalization: false

# Global parameter to set the exit ip address of services and public ports
port_publisher:
  # Execution Layer public port exposed to your local machine
  # Disabled by default
  # Public port start defaults to 32000
  # You can't run multiple enclaves on the same port settings
  el:
    enabled: true
    public_port_start: 32000
  # Consensus Layer public port exposed to your local machine
  # Disabled by default
  # Public port start defaults to 33000
  # You can't run multiple enclaves on the same port settings
  cl:
    enabled: true
    public_port_start: 33000
  # Validator client public port exposed to your local machine
  # Disabled by default
  # Public port start defaults to 34000
  # You can't run multiple enclaves on the same port settings
  vc:
    enabled: true
    public_port_start: 34000
  # remote signer public port exposed to your local machine
  # Disabled by default
  # Public port start defaults to 35000
  # You can't run multiple enclaves on the same port settings
  remote_signer:
    enabled: true
    public_port_start: 35000
  # Additional services public port exposed to your local machine
  # Disabled by default
  # Public port start defaults to 36000
  # You can't run multiple enclaves on the same port settings
  additional_services:
    enabled: true
    public_port_start: 36000

# Besu log4j files
extra_files:
  log4j2.xml: |
    <?xml version="1.0" encoding="UTF-8"?>
    <Configuration status="WARN">
        <Properties>
            <!-- Root console level remains INFO so you don't flood stdout -->
            <Property name="root.level">info</Property>
            <Property name="calltracer.level">TRACE</Property>
            <Property name="calltracer.file">/tmp/call_tracer_converter.log</Property>
            <Property name="debugtracer.file">/tmp/debug_tracer.log</Property>
            <Property name="pattern">%d{yyyy-MM-dd HH:mm:ss.SSSZZZ} | %t | %-5level | %c{1} | %msg%n</Property>
        </Properties>

        <Appenders>
            <Console name="Console" target="SYSTEM_OUT">
                <PatternLayout pattern="${pattern}"/>
            </Console>

            <!-- File for call tracer only -->
            <File name="CallTracerFile"
                  fileName="${calltracer.file}"
                  append="true"
                  immediateFlush="true">
                <PatternLayout pattern="${pattern}"/>
            </File>
            <!-- DebugOperationTracer -->
            <File name="DebugTracerFile"
                  fileName="${debugtracer.file}"
                  append="true"
                  immediateFlush="true">
                <PatternLayout pattern="${pattern}"/>
            </File>
        </Appenders>

        <Loggers>
            <!-- Narrow logger JUST for your class at TRACE -->
            <Logger name="org.hyperledger.besu.ethereum.api.jsonrpc.internal.results.CallTracerResultConverter"
                    level="${calltracer.level}"
                    additivity="false">
                <AppenderRef ref="CallTracerFile"/>
            </Logger>
    
            <!-- Add logger for DebugOperationTracer at TRACE/DEBUG -->
            <Logger name="org.hyperledger.besu.ethereum.vm.DebugOperationTracer"
                    level="TRACE"
                    additivity="false">
                <AppenderRef ref="DebugTracerFile"/>
            </Logger>

            <!-- Everything else at INFO to console -->
            <Root level="${root.level}">
                <AppenderRef ref="Console"/>
            </Root>
        </Loggers>
    </Configuration>
